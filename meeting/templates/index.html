<!DOCTYPE html>
<html lang="en">
<head>
    {% include 'includes/head.html' %}
    <title>메인 페이지</title>
    <link rel="stylesheet" href="/static/css/main.css">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css"
    integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l"
    crossorigin="anonymous">
    <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/fontawesome.min.css"> -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.6.0/font/bootstrap-icons.css" />
    <script>
        $(document).ready(function () {
            $("#card-list").html("");
            showArticles();
        });
        
        // function deleteArticle(_id) {
        //     $.ajax({
        //         type: "POST",
        //         url: "/api/delete",
        //         data: {postId_give: _id},
        //         success: function (response) {
        //             if (response['result'] == 'success') {
        //                 // 2. '삭제 완료!' 얼럿을 띄웁니다.
        //                 alert('삭제 완료!')
        //                 // 3. 변경된 정보를 반영하기 위해 새로고침합니다.
        //                 window.location.reload()
        //             }
        //         }
        //     });
        // }
        // // html을 대체하기
        // function editArticle(_id, title, content) {
        //     $(`#${_id}`).html(`<div class="card-body">
        //             <div class="form-group">
        //                 <input type="text" id="new-title" class="form-control" value="${title}">
        //             </div>
        //             <div class="form-group">
        //                 <textarea id="new-text" class="form-control" placeholder="" rows="2">${content}</textarea>
        //             </div>
        //             <button type="button" class="btn btn-primary" onclick="postEditArticle('${_id}')">저장</button>
        //         </div>`);
        // }

        function showArticles() {
            $.ajax({
                type: "GET",
                url: "/api/create",
                data: {},
                success: function(response){
                    let articles = response["articles"];
                    for (let i = 0; i < articles.length; i++) {
                        makeCard(articles[i]["_id"], articles[i]["title"], articles[i]["intro"])
                    }
                }
            })
        }

        function makeCard(_id, title, intro) {
            let temp_html = `<div class="card" id="${_id}">
                <div class="card-body">
                    <h4 class="card-title">${title}</h4>
                    <p class="card-text">${intro}</p>
                    <button type="button" class="btn btn-secondary" onclick="editArticle('${_id}, ${title}', '${intro}')">수정</button>
                    <button type="button" class="btn btn-dark" onclick="deleteArticle('${_id}')">삭제</button>
                </div>
            </div>`;
             $("#card-list").append(temp_html);
        }

        function goCreate() {
            let token = $.cookie('myToken');
            console.log(token)
            if (token !== undefined) {
                location.replace("/create")
            }
            else {
                alert("로그인이 필요합니다!")
            }
        }
    </script>
</head>
<body>
    {% include 'includes/header.html' %}
    <div class="wrap">

        <div id="card-list" class="card-columns">
            <div class="card">
                <div class="card-body">
                    <h4 class="card-title">첫번째 제목을 수정합니다.</h4>
                    <p class="card-text">첫번째 내용을 수정합니다.</p>
                    <button type="button" class="btn btn-secondary">수정</button>
                    <button type="button" class="btn btn-dark">삭제</button>
                </div>
            </div>
            <div class="card">
                <div class="card-body">
                    <h4 class="card-title">두번째 제목을 수정합니다.</h4>
                    <p class="card-text">두번째 내용을 수정합니다.</p>
                    <button type="button" class="btn btn-secondary">수정</button>
                    <button type="button" class="btn btn-dark">삭제</button>
                </div>
            </div>
            <div class="card">
                <div class="card-body">
                    <h4 class="card-title">세번째 제목을 수정합니다.</h4>
                    <p class="card-text">세번째 내용을 수정합니다.</p>
                    <button type="button" class="btn btn-secondary">수정</button>
                    <button type="button" class="btn btn-dark">삭제</button>
                </div>
            </div>
            <div class="card">
                <div class="card-body">
                    <h4 class="card-title">세번째 제목을 수정합니다.</h4>
                    <p class="card-text">세번째 내용을 수정합니다.</p>
                    <button type="button" class="btn btn-secondary">수정</button>
                    <button type="button" class="btn btn-dark">삭제</button>
                </div>
            </div>
        </div>
    </div>
    <div class= "createmoim">
        <!-- <button type = "button" class= "btn btn-primary" onclick="goCreate()">모임만들기</button> -->
        <i onclick="goCreate()" class= "bi bi-plus-circle-fill fs-1" fill="currentColor"></i>
    </div>
    {% include 'includes/plugin.html' %}
</body>
</html>